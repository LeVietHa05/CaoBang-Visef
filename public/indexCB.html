<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="main.css" />
    <title>CSSKVN.COM</title>
    <script
      type="module"
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.0.1/chart.min.js"
      integrity="sha512-tQYZBKe34uzoeOjY9jr3MX7R/mo7n25vnqbnrkskGr4D6YOoPYSpyafUAzQVjV6xAozAqUFIEFsCO4z8mnVBXA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@1,700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
  </head>
  <body>
    <header>
      <nav>
        <div id="logo">
          <a href=""
            ><img src="./vev-09.png" alt="" />
            <div>
              <p style="font-size: 2vw">CSSKVN.COM</p>
            </div></a
          >
        </div>
        <ul>
          <li><a href="#tab1" class="active">Trang chủ</a></li>
          <li><a href="#tab2">Thông tin bệnh nhân</a></li>
          <li><a href="#tab3">Thông tin bệnh viện</a></li>
          <li><a href="#tab4">Giới thiệu</a></li>
        </ul>
      </nav>
    </header>
    <!-- main -->
    <div class="tab-content">
      <div id="tab1" class="tab-pane active">
        <div id="banner">img or slide banner here</div>
        <div id="main">
          <div id="contents">
            <h2>Thông tin Y khoa</h2>
            <div class="post"></div>
          </div>
          <div class="loginTab">
            <h2>Đăng nhập</h2>
            <form action="/login" method="POST">
              <div class="input">
                <label for="username">Tên đăng nhập:</label>
                <input
                  type="text"
                  name="username"
                  id="username"
                  placeholder="số điện thoại của bạn"
                />
              </div>
              <div class="input">
                <label for="password">Mật khẩu:</label>
                <input
                  type="password"
                  name="password"
                  id="password"
                  placeholder="nhập mật khẩu của bạn"
                />
              </div>
              <div class="input">
                <input type="submit" value="Đăng nhập" />
              </div>
            </form>
          </div>
        </div>
      </div>
      <div id="tab2" class="tab-pane">
        <!-- <div id="notLogin">
          <div class="loginTab">
            <h2>Đăng nhập</h2>
            <form action="/login" method="POST">
              <div class="input">
                <label for="username">Tên đăng nhập:</label>
                <input
                  type="text"
                  name="username"
                  id="username"
                  placeholder="số điện thoại của bạn"
                />
              </div>
              <div class="input">
                <label for="password">Mật khẩu:</label>
                <input
                  type="password"
                  name="password"
                  id="password"
                  placeholder="nhập mật khẩu của bạn"
                />
              </div>
              <div class="input">
                <input type="submit" value="Đăng nhập" />
              </div>
            </form>
          </div>
        </div> -->
        <div id="logined">
          <a id="moveToTop" href="#logo">
            <div><span class="material-symbols-outlined"> step_out </span></div>
            Về đầu trang</a
          >
          <h2>Chỉ số cảm biến hiện tại</h2>
          <div id="indexLevel">
            <h3 style="grid-area: body">Chỉ số cơ thể</h3>
            <h3 style="grid-area: air">Chỉ số môi trường</h3>
            <div id="levelBar" style="grid-area: level">
              <p>Thấp</p>
              <div id="theLevel">
                <div title="low2"></div>
                <div title="low1"></div>
                <div title="normal"></div>
                <div title="high1"></div>
                <div title="high2"></div>
              </div>
              <p>Cao</p>
            </div>
          </div>

          <h2>
            Quãng đường di chuyển, luyện tập:
            <div id="distanceInfo" style="display: inline">32</div>
            m
          </h2>

          <div id="indexData">
            <div id="health">
              <div id="bloodPressure" style="grid-area: a">
                <a href="#bloodPressureChartArea">
                  <div>
                    <div>
                      <span class="material-symbols-outlined">
                        blood_pressure
                      </span>
                      <h3>Huyết áp:</h3>
                    </div>
                    <div>
                      <div id="systolicValue">120</div>
                      <p>/</p>
                      <div id="diastolicValue">90</div>
                      <p>mmHg</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="dropSpeed" style="grid-area: e">
                <a>
                  <div>
                    <div>
                      <span class="material-symbols-outlined"> speed </span>
                      <h3>Tốc độ nhỏ giọt:</h3>
                    </div>
                    <div>
                      <div id="dropSpeedValue">60</div>
                      <p>giọt/phút</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="heartRate" style="grid-area: b">
                <a href="#heartRateChartArea">
                  <div>
                    <div>
                      <span class="material-symbols-outlined">
                        health_metrics
                      </span>
                      <h3>Nhịp tim:</h3>
                    </div>
                    <div>
                      <div id="heartRateValue">80</div>
                      <p>bpm</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="SPO2" style="grid-area: c">
                <a href="#SPO2ChartArea">
                  <div>
                    <div>
                      <span class="material-symbols-outlined"> SPO2 </span>
                      <h3>SPO2:</h3>
                    </div>
                    <div>
                      <div id="SPO2Value">89</div>
                      <p>%</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="skinTemp" style="grid-area: d">
                <a href="#skinTempChartArea">
                  <div>
                    <div>
                      <span class="material-symbols-outlined">
                        thermometer
                      </span>
                      <h3>Nhiệt độ da:</h3>
                    </div>
                    <div>
                      <div id="skinTempValue">39</div>
                      <p>°C</p>
                    </div>
                  </div>
                </a>
              </div>
            </div>
            <div id="air">
              <div id="airTempHumidity">
                <a href="#airTempHumidityChartArea">
                  <div>
                    <div>
                      <span class="material-symbols-outlined"> sunny </span>
                      <h3>Nhiệt độ</h3>
                      <span class="material-symbols-outlined">
                        humidity_mid
                      </span>
                      <h3>Độ ẩm</h3>
                    </div>
                    <div>
                      <div id="airTempValue">22</div>
                      <p style="margin-right: 1vw">°C</p>
                      <div id="humidityValue">50</div>
                      <p>%</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="PM2">
                <a href="#PM2ChartArea">
                  <div>
                    <div>
                      <span class="material-symbols-outlined"> snowing </span>
                      <h3>PM2.5:</h3>
                    </div>
                    <div>
                      <div id="PM2Value">80</div>
                      <p> ug/m3</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="SO2">
                <a href="#SO2ChartArea">
                  <div>
                    <div><h3>SO2:</h3></div>
                    <div>
                      <div id="SO2Value">0.5</div>
                      <p>ppm</p>
                    </div>
                  </div>
                </a>
              </div>
              <div id="CO2">
                <a href="#CO2ChartArea">
                  <div>
                    <div><h3>CO2:</h3></div>
                    <div>
                      <div id="CO2Value">0.5</div>
                      <p>ppm</p>
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <!-- detail -->
          <h2>Biểu đồ chỉ số chi tiết</h2>

          <div id="mapArea" class="area">
            <h3>Vị trí hiện tại</h3>
            <div id="googleMap"></div>
          </div>
        </div>

        <!-- CHART -->
        <!-- bloodPressure chart -->
        <div id="bloodPressureChartArea" class="area">
          <h3>Huyết áp</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="bloodPressureChart"
          ></canvas>
        </div>

        <!-- bpm chart -->
        <div id="heartRateChartArea" class="area">
          <h3>Nhịp tim</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="heartChart"
          ></canvas>
        </div>

        <!-- SPO2 chart -->
        <div id="SPO2ChartArea" class="area">
          <h3>SPO2</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="SPO2cChart"
          ></canvas>
        </div>

        <!-- temp chart -->
        <div id="skinTempChartArea" class="area">
          <h3>Nhiệt độ bề mặt da</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="tempChart"
          ></canvas>
        </div>

        <!-- airTempHumidity chart -->
        <div id="airTempHumidityChartArea" class="area">
          <h3>Nhiệt độ và độ ẩm</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="airTempHumidityChart"
          ></canvas>
        </div>

        <!-- PM2.5 chart -->
        <div id="PM2ChartArea" class="area">
          <h3>PM2.5</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="PM2Chart"
          ></canvas>
        </div>

        <!-- SO2 chart -->
        <div id="SO2ChartArea" class="area">
          <h3>SO2</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="SO2Chart"
          ></canvas>
        </div>

        <!-- CO2 chart -->
        <div id="CO2ChartArea" class="area">
          <h3>CO2</h3>
          <canvas
            class="my-4 w-100 chartjs-render-monitor"
            id="CO2Chart"
          ></canvas>
        </div>

        <!-- setting -->
        <div id="setting">
          <div id="inSetting">
            <h2>Cảnh báo qua tin nhắn SMS</h2>
            <!-- currentPhone -->
            <div>
              <h3>Số điện thoại đang nhận cảnh báo:</h3>
              <h3 id="currentPhoneNumber">0834217367</h3>
            </div>
            <!-- changePhone -->

            <div>
              <h3>Đổi số điện thoại nhận cảnh báo:</h3>
              <div>
                <input
                  type="number"
                  id="newPhoneNumber"
                  name="newPhoneNumber"
                  placeholder="Nhập số muốn thay thế"
                />
                <button
                  type="button"
                  id="phone1btn"
                  class="btn btn-primary"
                  style="background-color: #f53131"
                >
                  Sửa số
                </button>
              </div>
            </div>
            <div>
              <h3>Thêm 1 số điện thoại nhận cảnh báo:</h3>
              <div>
                <input
                  type="text"
                  id="phone2"
                  name="phone2"
                  placeholder="Nhập thêm số cần nhận thông báo"
                />
                <button
                  type="button"
                  id="phone2btn"
                  class="btn btn-danger"
                  style="background-color: #34b257"
                >
                  Thêm số
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="tab3" class="tab-pane">
      <h2>Thông tin chung bệnh viện X tỉnh Cao Bằng</h2>
      <p>Giới thiệu Bệnh viện X tỉnh Cao Bằng</p>
      <p>Tên đơn vị: Bệnh viện X tỉnh Cao Bằng</p>
      <p>
        Địa chỉ: Đường ĐK, phường Tân Giang, thành phố Cao Bằng, tỉnh Cao Bằng.
      </p>
      <p>Điện thoại: 0206xxxx271 fax: 0206xxxx216</p>
      <p>Cơ quan chủ quan: Sở Y tế Cao Bằng Hạng bệnh viện: Đa khoa hạng II</p>
      <p>Sơ đồ bệnh viện:</p>
      <img src="soDoBenhVien.jpg" alt="" />
      <h2>Thông tin các khoa, phòng trong bệnh viện</h2>
      <p>Các khoa cận lâm sàng:</p>
      <ol>
        <li>Khoa dược</li>
        <li>Khoa chuẩn đoán chỉnh hình ảnh</li>
        <li>Khoa thăm dò chức năng</li>
        <li>Khoa dinh dưỡng</li>
        <li>Khoa xét nghiệm</li>
        <li>Khoa khám bệnh</li>
        <li>Khoa giải phẫu bệnh</li>
        <li>Khoa kiểm soát nhiễm khuẩn</li>
      </ol>
      <p>Các khoa lâm sàng:</p>
      <ol>
        <li>Khoa cấp cứu</li>
        <li>Khoa hồi sức tích cực, chống độc và thận nhân tạo</li>
        <li>Khoa chấn thương chỉnh hình</li>
        <li>Khoa gây mê hồi sức</li>
        <li>Khoa tai mũi họng</li>
        <li>Khoa mắt</li>
        <li>Khoa răng hàm mặt</li>
        <li>Khoa nội tim mạch</li>
      </ol>
      <p>Các phòng chức năng:</p>
      <ol>
        <li>Phòng hành chính quản trị</li>
        <li>Phòng điều dưỡng</li>
        <li>Phòng công tác xã hội</li>
        <li>Phòng kế hoạch tổng hợp</li>
        <li>Phòng tài chính kế toán</li>
        <li>Phòng tổ chức cán bộ</li>
        <li>Phòng đào tạo chỉ đạo tuyến</li>
      </ol>
    </div>
    <div id="tab4" class="tab-pane">
      <h2>GIỚI THIỆU CHUNG VỀ DỰ ÁN</h2>
      <p>
        <b
          >Thiết bị hỗ trợ chăm sóc sức khỏe cho bệnh nhân và người bệnh phục
          hồi sau phẫu thuật</b
        >
        là thiết bị hỗ trợ chăm sóc sức khỏe cho bệnh nhân và người bệnh phục
        hồi sau phẫu thuật với các tính năng nổi bật vượt trội:
      </p>
      <ul>
        <li>Hỗ trợ di chuyển</li>
        <li>
          Tích hợp cảm biến đo các chỉ số: nhịp tim, SPO2, thân nhiệt, huyết áp.
        </li>
        <li>
          Tích hợp cảm biến đo các chỉ số môi trường: Độ ẩm không khí, nồng độ
          SO2, CO/CO2, bụi mịn MP2.5,…
        </li>

        <li>
          Tích hợp hệ thống cảm biến hồng ngoại và bánh xe di chuyển đo chính
          xác quãng đường di chuyển của người dùng
        </li>
        <li>Tích hợp hệ thống đếm dịch truyền</li>
        <li>
          Tích hợp hệ thống SIM, GPS, cảm biến góc nghiêng, cảm biến siêu âm
          nhằm phát hiện kịp thời các sai lệch chuyển động dấu hiệu ngã, nguy
          hiểm của người dùng và gửi tin nhắn cảnh báo về vị trí hiện tại của
          người dùng tới điện thoại cho người thân, bác sĩ.
        </li>

        <li>
          Tất cả các chỉ số và thông tin đo được luôn cập nhật nhanh chóng và
          chính xác lên “hồ sơ cá nhân” của từng người sử dụng trên Webserver để
          theo dõi và đưa ra những dự báo phù hợp với sức khỏe người dùng.
        </li>
      </ul>
      <p>
        Với giá thành rẻ, chất liệu an toàn với môi trường và người sử dụng,
        <b
          >Thiết bị hỗ trợ chăm sóc sức khỏe cho bệnh nhân và người bệnh phục
          hồi sau phẫu thuật</b
        >
        hứa hẹn sẽ trở thành thiết bị nổi trội được tin dùng trong ngành Y Sinh
        và Khoa học trong thời gian sắp tới.
      </p>
    </div>

    <!-- footer -->
    <footer>
      <div id="footerLeft">
        <h3>
          Dự án: Thiết bị hỗ trợ chăm sóc sức khỏe cho bệnh nhân và người bệnh
          phục hồi sau phẫu thuật
        </h3>
        <p>
          Trang dự án nghiên cứu khoa học của trường Trung học phổ thông Chuyên
          tỉnh Cao Bằng
        </p>
        <p>
          Địa chỉ: tổ 6, phường Hòa Chung, thành phố Cao Bằng, tỉnh Cao Bằng
        </p>
      </div>
      <div id="footerRight">
        <h3>Bản quyền thuộc về:</h3>
        <ol>
          <li>Hoàng Hồng Anh - Lớp 10 Chuyên Anh</li>
          <li>Nguyễn Hoàng Như Hạnh - Lớp 12 Chuyên Văn</li>
          <li>Tô Thị Kiểm - Giáo viên hướng dẫn</li>
        </ol>
        <p>Điện thoại: 0902055664 - 094158448 - 0834217367</p>
      </div>
    </footer>
    <!-- script -->
    <script src="script.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- socketio -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
      let LAT = 21.019536;
      let LNG = 105.799487;

      const socket = io();

      const skinTempInfo = document.getElementById("skinTempValue");
      const heartInfo = document.getElementById("heartRateValue");
      const SPO2Info = document.getElementById("SPO2Value");
      const distanceInfo = document.getElementById("distanceInfo");
      const dropSpeedInfo = document.getElementById("dropSpeedValue");
      const systolicInfo = document.getElementById("systolicValue");
      const diastolicInfo = document.getElementById("diastolicValue");
      const airTempInfo = document.getElementById("airTempValue");
      const airHumidityInfo = document.getElementById("airHumidityValue");
      const SO2Info = document.getElementById("SO2Value");
      const CO2Info = document.getElementById("CO2Value");
      const PM2Info = document.getElementById("PM2Value");

      const phone1Input = document.getElementById("phone1");
      const phone2Input = document.getElementById("phone2");
      const phone1btn = document.getElementById("phone1btn");
      const phone2btn = document.getElementById("phone2btn");

      const currentPhoneNumber = document.getElementById("currentPhoneNumber");

      phone1btn.addEventListener("click", () => {
        let tam = Number(phone1Input.value);
        if (phone1Input.value == "" || phone1Input.value == null) {
          alert("Vui lòng nhập số điện thoại");
          return;
        } else if (isNaN(tam)) {
          alert("Vui lòng nhập số điện thoại");
          return;
        } else if (phone1Input.value.length != 10) {
          alert("Vui lòng nhập đúng số điện thoại");
          return;
        }
        socket.emit("phone1", phone1Input.value);
        currentPhoneNumber.innerHTML = `Số đang nhận: ${phone1Input.value}; ${phone2Input.value}`;
      });
      phone2btn.addEventListener("click", () => {
        let tam = Number(phone2Input.value);
        if (phone2Input.value == "" || phone2Input.value == null) {
          alert("Vui lòng nhập số điện thoại");
          return;
        } else if (isNaN(tam)) {
          alert("Vui lòng nhập số điện thoại");
          return;
        } else if (phone2Input.value.length != 10) {
          alert("Vui lòng nhập đúng số điện thoại");
          return;
        }
        socket.emit("phone2", phone2Input.value);
        currentPhoneNumber.innerHTML = `Số đang nhận: ${phone1Input.value}; ${phone2Input.value}`;
      });

      socket.on("message", (data) => {
        console.log(data);
        skinTempInfo.innerHTML = data.temp;
        heartInfo.innerHTML = data.heart;
        SPO2Info.innerHTML = data.SPO2;
        dropSpeedInfo.innerHTML = data.dropSpeed;
        systolicInfo.innerHTML = data.systolic;
        diastolicInfo.innerHTML = data.diastolic;
        airTempInfo.innerHTML = data.airTemp;
        airHumidityInfo.innerHTML = data.airHumidity;
        SO2Info.innerHTML = data.SO2;
        CO2Info.innerHTML = data.CO2;
        PM2Info.innerHTML = data.PM2;
        distanceInfo.innerHTML = data.distance;
        //for map
        if (
          data.lng != null &&
          data.lat != null &&
          data.lng != 0 &&
          data.lat != 0
        ) {
          LNG = Number(data.lng);
          LAT = Number(data.lat);
          updateMarkerPosition(LAT, LNG);
        }

        setData(tempData.datasets[0].data, data.temp);
        setData(heartData.datasets[0].data, data.heart);
        setData(SP02.datasets[0].data, data.SPO2);
        setData(bloodPressureChart.datasets[0].data, data.systolic);
        setData(bloodPressureChart.datasets[1].data, data.diastolic);
        setData(airTempHumidityData.datasets[0].data, data.airTemp);
        setData(airTempHumidityData.datasets[1].data, data.airHumidity);
        setData(SO2Data.datasets[0].data, data.SO2);
        setData(CO2Data.datasets[0].data, data.CO2);
        setData(PM2Data.datasets[0].data, data.PM2);

        setData
        tempChart.update();
        heartChart.update();
        SPO2Chart.update();
        bloodPressureChart.update();
        airTempHumidityChart.update();
        SO2Chart.update();
        CO2Chart.update();
        PM2Chart.update();

        if (data.notify == 1) {
          alert("Cảnh báo: Bệnh nhân cần được chăm sóc");
        }

        // myMap();
      });
    </script>

    <!-- google map -->
    <script>
      let marker;
      let map;

      function myMap() {
        const vuphamham = {
          center: {
            lat: 21.019536,
            lng: 105.799487,
          },
          zoom: 15,
        };
        if (LNG !== 0 || LAT !== 0) {
          vuphamham.center = {
            lat: LAT,
            lng: LNG,
          };
        }
        map = new google.maps.Map(
          document.getElementById("googleMap"),
          vuphamham
          // mapProp2
        );

        marker = new google.maps.Marker({
          position: vuphamham.center,
          map: map,
        });
      }

      function updateMarkerPosition(lat, lng) {
        // Update the position of the marker
        marker.setPosition({
          lat: lat,
          lng: lng,
        });

        // Update the center of the map to the new position
        map.panTo({
          lat: lat,
          lng: lng,
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBV0leErtS7dmiYz-zuz6xvTbWtzLq3TQ&callback=myMap"></script>

    <!-- chart -->
    <script>
      var ctx_temp = document.getElementById("tempChart").getContext("2d");
      var ctx_heart = document.getElementById("heartChart").getContext("2d");
      var ctx_SPO2 = document.getElementById("SPO2cChart").getContext("2d");
      var ctx_bloodPressure = document
        .getElementById("bloodPressureChart")
        .getContext("2d");
      var ctx_airTempHumidity = document
        .getElementById("airTempHumidityChart")
        .getContext("2d");
      var ctx_CO2 = document.getElementById("CO2Chart").getContext("2d");
      var ctx_PM2 = document.getElementById("PM2Chart").getContext("2d");
      var ctx_SO2 = document.getElementById("SO2Chart").getContext("2d");
      var bloodPressureData = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Huyết áp (mmHg)",
            data: [180, 166, 145, 140, 122, 124, 117],
            borderColor: "red",
            borderWidth: 1,
            pointBorderWidth: 3,
            tension: 0.1,
          },
          {
            label: "Huyết áp (mmHg)",
            data: [110, 118, 100, 94, 80, 82, 75],
            borderColor: "blue",
            borderWidth: 1,
            pointBorderWidth: 3,
            tension: 0.1,
          },
        ],
      };
      let systolicDataValue =
        bloodPressureData.datasets[0].data[
          bloodPressureData.datasets[0].data.length - 1
        ];
      let diastolicDataValue =
        bloodPressureData.datasets[1].data[
          bloodPressureData.datasets[1].data.length - 1
        ];

      var tempData = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Nhiệt độ bề mặt da (°C)",
            data: [1, 0, 31, 10, 50, 30, 36, 38, 38.2, 34, 39, 37.8],
            borderColor: "#4152A3",
            borderWidth: 1,
            pointBorderWidth: 3,
            tension: 0.1,
          },
        ],
      };
      let tempDataValue =
        tempData.datasets[0].data[tempData.datasets[0].data.length - 1];

      var heartData = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Nhịp tim (lần/phút)",
            data: [80, 69, 120, 70, 50, 60, 66],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "#4152A3",
            tension: 0.1,
          },
        ],
      };
      let heartDataValue =
        heartData.datasets[0].data[heartData.datasets[0].data.length - 1];

      var SP02 = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Nồng độ Oxy trong máu (%)",
            data: [100, 80, 99, 98, 92],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "#4152A3",
            tension: 0.1,
          },
        ],
      };
      let SP02DataValue =
        SP02.datasets[0].data[SP02.datasets[0].data.length - 1];

      var airTempHumidityData = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],

        datasets: [
          {
            label: "Nhiệt độ môi trường (°C)",
            data: [35, 24, 25, 34, 27, 28, 29, 30, 31, 44],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "red",
            tension: 0.1,
          },
          {
            label: "Độ ẩm trong không khí (%)",
            data: [30, 20, 12, 16, 0, 19, 50, 25, 26, 27, 28, 29, 30, 31, 46],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "#4152A3",
            tension: 0.1,
          },
        ],
      };
      let airTempDataValue =
        airTempHumidityData.datasets[0].data[
          airTempHumidityData.datasets[0].data.length - 1
        ];
      let airHumidityDataValue =
        airTempHumidityData.datasets[1].data[
          airTempHumidityData.datasets[1].data.length - 1
        ];

      var CO2Data = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Nồng độ CO2 trong không khí (ppm)",
            data: [20, 21, 22, 23, 24, 25, 50, 27, 28, 29, 30, 31],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "#4152A3",
            tension: 0.1,
          },
        ],
      };
      let CO2DataValue =
        CO2Data.datasets[0].data[CO2Data.datasets[0].data.length - 1];

      var SO2Data = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Nồng độ SO2 trong không khí (ppm)",
            data: [100, 99, 80, 88, 92, 97, 22, 21, 10],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "#4152A3",
            tension: 0.1,
          },
        ],
      };
      let SO2DataValue =
        SO2Data.datasets[0].data[SO2Data.datasets[0].data.length - 1];

      var PM2 = {
        labels: [
          60, 58, 56, 54, 52, 50, 48, 46, 44, 42, 40, 38, 36, 34, 32, 30, 28,
          26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2, 0,
        ],
        datasets: [
          {
            label: "Nồng độ bụi PM2.5 trong không khí (ppm)",
            data: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1200],
            borderWidth: 1,
            pointBorderWidth: 3,
            borderColor: "#4152A3",
            tension: 0.1,
          },
        ],
      };
      let PM2DataValue = PM2.datasets[0].data[PM2.datasets[0].data.length - 1];

      var tempOption = {
        // responsive: false,
        y: {
          suggestedMin: 35,
          suggestedMax: 42,
        },
      };
      var heartOption = {
        // responsive: false,
        y: {
          suggestedMin: 50,
          suggestedMax: 120,
        },
      };
      var SPO2Option = {
        // responsive: false,
        y: {
          suggestedMin: 80,
          suggestedMax: 100,
        },
      };

      var tempChart = new Chart(ctx_temp, {
        type: "line",
        data: tempData,
        options: tempOption,
      });

      var heartChart = new Chart(ctx_heart, {
        type: "line",
        data: heartData,
        options: heartOption,
      });

      var SPO2Chart = new Chart(ctx_SPO2, {
        type: "line",
        data: SP02,
        options: SPO2Option,
      });
      var bloodPressureChart = new Chart(ctx_bloodPressure, {
        type: "line",
        data: bloodPressureData,
        options: tempOption,
      });
      var airTempHumidityChart = new Chart(ctx_airTempHumidity, {
        type: "line",
        data: airTempHumidityData,
        options: tempOption,
      });
      var PM2Chart = new Chart(ctx_PM2, {
        type: "line",
        data: PM2,
        options: tempOption,
      });
      var CO2Chart = new Chart(ctx_CO2, {
        type: "line",
        data: CO2Data,
        options: tempOption,
      });
      var SO2Chart = new Chart(ctx_SO2, {
        type: "line",
        data: SO2Data,
        options: tempOption,
      });

      function setData(dataset, data) {
        dataset.push(data);
        dataset.shift();
      }
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>

    <script>
      // get data to show in Index
      document.querySelector("#skinTempValue").innerHTML = tempDataValue;
      document.querySelector("#heartRateValue").innerHTML = heartDataValue;
      document.querySelector("#SPO2Value").innerHTML = SP02DataValue;
      document.querySelector("#systolicValue").innerHTML = systolicDataValue;
      document.querySelector("#diastolicValue").innerHTML = diastolicDataValue;
      document.querySelector("#airTempValue").innerHTML = airTempDataValue;
      document.querySelector("#humidityValue").innerHTML = airHumidityDataValue;
      document.querySelector("#PM2Value").innerHTML = PM2DataValue;
      document.querySelector("#CO2Value").innerHTML = CO2DataValue;
      document.querySelector("#SO2Value").innerHTML = SO2DataValue;

      // chage the color due the value

      // temp
      if (tempDataValue >= 40) {
        document.querySelector("#skinTemp").style.backgroundColor = "#bf0000";
        document.querySelector("#skinTemp").style.color = "white";
      } else if (tempDataValue >= 39) {
        document.querySelector("#skinTemp").style.backgroundColor = "#f53131";
        document.querySelector("#skinTemp").style.color = "black";
      } else if (tempDataValue >= 38) {
        document.querySelector("#skinTemp").style.backgroundColor = "#f06969";
        document.querySelector("#skinTemp").style.color = "black";
      } else if (tempDataValue >= 37.5) {
        document.querySelector("#skinTemp").style.backgroundColor = "#ffbf00";
        document.querySelector("#skinTemp").style.color = "black";
      } else if (tempDataValue >= 36) {
        document.querySelector("#skinTemp").style.backgroundColor = "#34b257";
        document.querySelector("#skinTemp").style.color = "black";
      } else {
        document.querySelector("#skinTemp").style.backgroundColor = "#bf0000";
        document.querySelector("#skinTemp").style.color = "white";
      }

      // heart
      if (heartDataValue >= 100) {
        document.querySelector("#heartRate").style.backgroundColor = "#bf0000";
        document.querySelector("#heartRate").style.color = "white";
      } else if (heartDataValue >= 80) {
        document.querySelector("#heartRate").style.backgroundColor = "#f53131";
        document.querySelector("#heartRate").style.color = "black";
      } else if (heartDataValue >= 68) {
        document.querySelector("#heartRate").style.backgroundColor = "#f06969";
        document.querySelector("#heartRate").style.color = "black";
      } else if (heartDataValue >= 62) {
        document.querySelector("#heartRate").style.backgroundColor = "#ffbf00";
        document.querySelector("#heartRate").style.color = "black";
      } else if (heartDataValue >= 54) {
        document.querySelector("#heartRate").style.backgroundColor = "#34b257";
        document.querySelector("#heartRate").style.color = "black";
      } else {
        document.querySelector("#heartRate").style.backgroundColor = "#f53131";
        document.querySelector("#heartRate").style.color = "black";
      }

      // SPO2
      if (SO2DataValue <= 88) {
        document.querySelector("#SPO2").style.backgroundColor = "#bf0000";
        document.querySelector("#SPO2").style.color = "white";
      } else if (SO2DataValue <= 92) {
        document.querySelector("#SPO2").style.backgroundColor = "#f53131";
        document.querySelector("#SPO2").style.color = "black";
      } else if (SO2DataValue <= 95) {
        document.querySelector("#SPO2").style.backgroundColor = "#ffbf00";
        document.querySelector("#SPO2").style.color = "black";
      } else if (SO2DataValue <= 100) {
        document.querySelector("#SPO2").style.backgroundColor = "#34b257";
        document.querySelector("#SPO2").style.color = "black";
      } else {
        document.querySelector("#SPO2").style.backgroundColor = "#bf0000";
        document.querySelector("#SPO2").style.color = "white";
        document.querySelector("#SPO2Num").innerHTML = "N/A";
      }

      // blood pressure
      if (systolicDataValue - diastolicDataValue <= 20) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#bf0000";
        document.querySelector("#bloodPressure").style.color = "white";
      } else if (systolicDataValue >= 180 || diastolicDataValue >= 110) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#f53131";
        document.querySelector("#bloodPressure").style.color = "black";
      } else if (systolicDataValue >= 160 || diastolicDataValue >= 100) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#f06969";
        document.querySelector("#bloodPressure").style.color = "black";
      } else if (systolicDataValue >= 140 || diastolicDataValue >= 90) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#ffbf00";
        document.querySelector("#bloodPressure").style.color = "black";
      } else if (systolicDataValue >= 130 || diastolicDataValue >= 85) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#B6BA00";
        document.querySelector("#bloodPressure").style.color = "black";
      } else if (systolicDataValue >= 120 || diastolicDataValue >= 80) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#4E8B00";
        document.querySelector("#bloodPressure").style.color = "black";
      } else if (systolicDataValue >= 90 || diastolicDataValue >= 60) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#34B257";
        document.querySelector("#bloodPressure").style.color = "black";
      } else if (systolicDataValue < 90 || diastolicDataValue < 60) {
        document.querySelector("#bloodPressure").style.backgroundColor =
          "#bf0000";
        document.querySelector("#bloodPressure").style.color = "white";
      }

      // air humidity
      if (airHumidityDataValue >= 65) {
        document.querySelector("#airTempHumidity").style.backgroundColor =
          "#f53131";
        document.querySelector("#airTempHumidity").style.color = "black";
      } else if (airHumidityDataValue >= 55) {
        document.querySelector("#airTempHumidity").style.backgroundColor =
          "#ffbf00";
        document.querySelector("#airTempHumidity").style.color = "black";
      } else if (airHumidityDataValue >= 45) {
        document.querySelector("#airTempHumidity").style.backgroundColor =
          "#34b257";
        document.querySelector("#airTempHumidity").style.color = "black";
      } else {
        document.querySelector("#airTempHumidity").style.backgroundColor =
          "#ffbf00";
        document.querySelector("#airTempHumidity").style.color = "black";
      }

      // SO2 using ppb = 1/1000 ppm
      if (SO2DataValue > 20) {
        document.querySelector("#SO2").style.backgroundColor = "#bf0000";
        document.querySelector("#SO2").style.color = "white";
      } else {
        document.querySelector("#SO2").style.backgroundColor = "#34b257";
        document.querySelector("#SO2").style.color = "black";
      }

      // CO2
      if (CO2DataValue >= 5000) {
        document.querySelector("#CO2").style.backgroundColor = "#bf0000";
        document.querySelector("#CO2").style.color = "white";
      } else if (CO2DataValue >= 2000) {
        document.querySelector("#CO2").style.backgroundColor = "#f53131";
        document.querySelector("#CO2").style.color = "black";
      } else if (CO2DataValue >= 1000) {
        document.querySelector("#CO2").style.backgroundColor = "#f06969";
        document.querySelector("#CO2").style.color = "black";
      } else if (CO2DataValue >= 350) {
        document.querySelector("#CO2").style.backgroundColor = "#ffbf00";
        document.querySelector("#CO2").style.color = "black";
      } else {
        document.querySelector("#CO2").style.backgroundColor = "#34b257";
        document.querySelector("#CO2").style.color = "black";
      } 
      
      // PM2.5 using ug/m3 = 1/1000 ppm
      if (PM2DataValue >= 150.4) {
        document.querySelector("#PM2").style.backgroundColor = "#bf0000";
        document.querySelector("#PM2").style.color = "white";
      } else if (PM2DataValue >= 55.5) {
        document.querySelector("#PM2").style.backgroundColor = "#f53131";
        document.querySelector("#PM2").style.color = "black";
      } else if (PM2DataValue >= 35.5) {
        document.querySelector("#PM2").style.backgroundColor = "#f06969";
        document.querySelector("#PM2").style.color = "black";
      } else if (PM2DataValue >= 12.1) {
        document.querySelector("#PM2").style.backgroundColor = "#ffbf00";
        document.querySelector("#PM2").style.color = "black";
      } else {
        document.querySelector("#PM2").style.backgroundColor = "#34b257";
        document.querySelector("#PM2").style.color = "black";
      } 


    </script>
  </body>
</html>
